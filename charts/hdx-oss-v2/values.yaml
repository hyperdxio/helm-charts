global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClassName: []

hyperdx:
  image: "hyperdx/hyperdx:2-beta"
  apiKey: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
  apiPort: 8000
  appPort: 3000
  appUrl: "http://localhost"
  logLevel: "info"
  usageStatsEnabled: true
  annotations: {}
    # myAnnotation: "myValue"
  labels: {}
    # myLabel: "myValue"
  env: []
    # Additional environment variables can be configured here
    # This is preserved for backward compatibility and advanced use cases

  # Default connections and sources (ENABLED BY DEFAULT)
  # Set to empty string to disable: defaultConnections: ""
  defaultConnections: |
    [
      {
        "name": "Local ClickHouse",
        "host": "{{ include "hdx-oss.fullname" . }}-clickhouse",
        "port": 8123,
        "username": "app",
        "password": "{{ .Values.clickhouse.config.users.appUserPassword }}"
      }
    ]

  # Set to empty string to disable: defaultSources: ""
  defaultSources: |
    [
      {
        "from": {
          "databaseName": "default",
          "tableName": "otel_logs"
        },
        "kind": "log",
        "timestampValueExpression": "TimestampTime",
        "name": "Logs",
        "displayedTimestampValueExpression": "Timestamp",
        "implicitColumnExpression": "Body",
        "serviceNameExpression": "ServiceName",
        "bodyExpression": "Body",
        "eventAttributesExpression": "LogAttributes",
        "resourceAttributesExpression": "ResourceAttributes",
        "defaultTableSelectExpression": "Timestamp,ServiceName,SeverityText,Body",
        "severityTextExpression": "SeverityText",
        "traceIdExpression": "TraceId",
        "spanIdExpression": "SpanId",
        "connection": "Local ClickHouse",
        "traceSourceId": "Traces",
        "sessionSourceId": "Sessions",
        "metricSourceId": "Metrics"
      },
      {
        "from": {
          "databaseName": "default",
          "tableName": "otel_traces"
        },
        "kind": "trace",
        "timestampValueExpression": "Timestamp",
        "name": "Traces",
        "displayedTimestampValueExpression": "Timestamp",
        "implicitColumnExpression": "SpanName",
        "serviceNameExpression": "ServiceName",
        "bodyExpression": "SpanName",
        "eventAttributesExpression": "SpanAttributes",
        "resourceAttributesExpression": "ResourceAttributes",
        "defaultTableSelectExpression": "Timestamp,ServiceName,StatusCode,round(Duration/1e6),SpanName",
        "traceIdExpression": "TraceId",
        "spanIdExpression": "SpanId",
        "durationExpression": "Duration",
        "durationPrecision": 9,
        "parentSpanIdExpression": "ParentSpanId",
        "spanNameExpression": "SpanName",
        "spanKindExpression": "SpanKind",
        "statusCodeExpression": "StatusCode",
        "statusMessageExpression": "StatusMessage",
        "connection": "Local ClickHouse",
        "logSourceId": "Logs",
        "sessionSourceId": "Sessions",
        "metricSourceId": "Metrics"
      },
      {
        "from": {
          "databaseName": "default",
          "tableName": ""
        },
        "kind": "metric",
        "timestampValueExpression": "TimeUnix",
        "name": "Metrics",
        "resourceAttributesExpression": "ResourceAttributes",
        "metricTables": {
          "gauge": "otel_metrics_gauge",
          "histogram": "otel_metrics_histogram",
          "sum": "otel_metrics_sum",
          "_id": "682586a8b1f81924e628e808",
          "id": "682586a8b1f81924e628e808"
        },
        "connection": "Local ClickHouse",
        "logSourceId": "Logs",
        "traceSourceId": "Traces",
        "sessionSourceId": "Sessions"
      },
      {
        "from": {
          "databaseName": "default",
          "tableName": "hyperdx_sessions"
        },
        "kind": "session",
        "timestampValueExpression": "TimestampTime",
        "name": "Sessions",
        "displayedTimestampValueExpression": "Timestamp",
        "implicitColumnExpression": "Body",
        "serviceNameExpression": "ServiceName",
        "bodyExpression": "Body",
        "eventAttributesExpression": "LogAttributes",
        "resourceAttributesExpression": "ResourceAttributes",
        "defaultTableSelectExpression": "Timestamp,ServiceName,SeverityText,Body",
        "severityTextExpression": "SeverityText",
        "traceIdExpression": "TraceId",
        "spanIdExpression": "SpanId",
        "connection": "Local ClickHouse",
        "logSourceId": "Logs",
        "traceSourceId": "Traces",
        "metricSourceId": "Metrics"
      }
    ]
  
  # See https://github.com/hyperdxio/hyperdx/blob/v2/packages/api/docs/auto_provision/AUTO_PROVISION.md
  # for detailed configuration options

  ingress:
    enabled: false
    host: "localhost"  # Production domain
    proxyBodySize: "100m"
    proxyConnectTimeout: "60"
    proxySendTimeout: "60"
    proxyReadTimeout: "60"
    tls:
      enabled: false
      secretName: "hyperdx-tls"
  replicas: 1

mongodb:
  image: "mongo:5.0.14-focal"
  port: 27017

clickhouse:
  image: "clickhouse/clickhouse-server:24-alpine"
  port: 8123
  nativePort: 9000
  enabled: true
  persistence:
    enabled: true
    dataSize: 10Gi
    logSize: 5Gi
  config:
    users:
      appUserPassword: "hyperdx"
      otelUserPassword: "otelcollectorpass"
    # Network CIDR for Kubernetes cluster (adjust for your cluster). Ensures connections are locked down to intra cluster only.
    # Common values: "10.0.0.0/8" (most k8s), "192.168.0.0/16" (OrbStack), "172.16.0.0/12" (some clouds)
    clusterCidr: "10.0.0.0/8"

otel:
  image: "hyperdx/hyperdx-otel-collector:2-beta"
  port: 13133
  nativePort: 24225
  grpcPort: 4317
  httpPort: 4318
  healthPort: 8888
  enabled: true
  # Clickhouse endpoint - defaults to built-in Clickhouse service
  clickhouseEndpoint:

persistence:
  mongodb:
    enabled: true
    size: 10Gi

tasks:
  enabled: false
  checkAlerts:
    schedule: "*/1 * * * *"  # Runs every 1 minute
    resources:
      limits:
        cpu: 200m
        memory: 256Mi
      requests:
        cpu: 100m
        memory: 128Mi
